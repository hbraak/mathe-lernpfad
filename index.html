<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathe-Lernpfad: Ableitungsregeln</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="screen active">
        <div class="login-box">
            <h1>ğŸ“ Mathe-Lernpfad</h1>
            <h2>Produkt- & Kettenregel</h2>
            <p>12NP â€” Lore-Lorentz-Schule</p>
            <div class="login-form">
                <label for="student-nr">Deine Klassenlistennummer:</label>
                <input type="number" id="student-nr" min="1" max="25" placeholder="1â€“25">
                <button id="login-btn" onclick="doLogin()">Start</button>
                <p class="hint">Dein Fortschritt wird gespeichert.</p>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="app-screen" class="screen">
        <!-- Top Bar -->
        <div id="topbar">
            <div id="topbar-left">
                <span id="student-label">Nr. â€”</span>
                <span id="unit-label">Diagnose</span>
            </div>
            <div id="progress-bar-container">
                <div id="progress-bar"></div>
            </div>
            <div id="topbar-right">
                <button id="gemini-toggle" onclick="toggleGemini()" title="KI-Tutor">ğŸ’¬</button>
            </div>
        </div>

        <!-- Content Area -->
        <div id="content-wrapper">
            <div id="content-area">
                <!-- Dynamically filled -->
            </div>

            <!-- Gemini Chat Panel -->
            <div id="gemini-panel" class="hidden">
                <div id="gemini-header">
                    <span>ğŸ¤– KI-Tutor</span>
                    <button onclick="toggleGemini()">âœ•</button>
                </div>
                <div id="gemini-messages"></div>
                <div id="gemini-input-area">
                    <input type="text" id="gemini-input" placeholder="Fragen Sie mich etwas..." onkeydown="if(event.key==='Enter')sendGemini()"
                           inputmode="text" enterkeyhint="send" autocomplete="off" autocorrect="on" autocapitalize="sentences" spellcheck="true">
                    <button type="button" id="gemini-mic-btn" class="mic-btn" onclick="toggleSpeechInput('gemini-input','gemini-mic-btn', false)"
                            title="Frage per Sprache eingeben" aria-label="Frage per Sprache eingeben">ğŸ¤</button>
                    <button type="button" class="send-btn" onclick="sendGemini()">â†’</button>
                </div>
                <p class="gemini-hint" id="gemini-speech-hint" hidden>Sie kÃ¶nnen auch per Sprache eingeben ğŸ¤</p>
                <p class="gemini-hint">âš ï¸ Keine Namen oder persÃ¶nliche Daten eingeben!</p>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>
